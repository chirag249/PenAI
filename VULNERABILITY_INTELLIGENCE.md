# Vulnerability Intelligence Integration for PenAI

This document describes the external intelligence integration capabilities added to the PenAI framework.

## National Vulnerability Database (NVD) Integration

The framework now integrates with the NVD to provide up-to-date vulnerability information:

### Features

1. **CVE Correlation**: Automatically correlates discovered vulnerabilities with CVE data
2. **Real-time Lookup**: Fetches current vulnerability information from NVD API
3. **Caching**: Caches vulnerability data to reduce API calls and improve performance
4. **Keyword Search**: Supports keyword-based vulnerability searches

### Configuration

To enable NVD integration:

```bash
export NVD_API_KEY="your-nvd-api-key"
```

### Usage

The integration works automatically during scans. To manually query NVD:

```python
from modules.vuln_intel import get_nvd_vulnerabilities

# Get recent vulnerabilities
vulns = get_nvd_vulnerabilities(days_back=30)

# Search for vulnerabilities by keyword
wordpress_vulns = get_nvd_vulnerabilities(keyword="wordpress", days_back=90)

# Get specific CVE information
cve_info = get_nvd_vulnerabilities(cve_id="CVE-2021-44228")
```

## Threat Intelligence Integration

The framework incorporates threat intelligence feeds to enhance detection capabilities:

### Features

1. **Emerging Threats**: Tracks new exploitation techniques and attack patterns
2. **Malware Indicators**: Integrates with malware indicator feeds
3. **IP Blacklists**: Incorporates known malicious IP addresses
4. **Extensible Design**: Easily extendable to integrate with commercial threat intelligence providers

### Usage

Threat intelligence is automatically incorporated during scans. To manually retrieve feeds:

```python
from modules.vuln_intel import get_threat_intel_feeds

# Get current threat intelligence feeds
threat_intel = get_threat_intel_feeds()
```

## Exploit Database Correlation

The framework correlates discovered vulnerabilities with known exploits:

### Features

1. **ExploitDB Integration**: Cross-references vulnerabilities with ExploitDB
2. **Metasploit Integration**: Checks for available Metasploit modules
3. **Risk Assessment**: Enhances vulnerability risk scoring based on exploit availability

### Usage

Exploit correlation happens automatically during scans. To manually check:

```python
from modules.vuln_intel import correlate_with_exploit_db

# Correlate vulnerabilities with exploit database
vulns_with_exploits = correlate_with_exploit_db(vulnerabilities_list)
```

## Integration with Existing Modules

The intelligence integration works seamlessly with existing PenAI modules:

1. **Findings Enhancement**: Automatically enriches findings with CVE and exploit information
2. **Reporting**: Includes intelligence data in generated reports
3. **AI Analysis**: Feeds intelligence data to AI modules for enhanced analysis

## Custom Intelligence Sources

The framework is designed to be extensible with custom intelligence sources:

```python
# Extend the VulnerabilityIntel class
class CustomIntel(VulnerabilityIntel):
    def get_custom_threat_feed(self):
        # Implement custom threat feed integration
        pass

# Use custom intelligence
custom_intel = CustomIntel()
threat_data = custom_intel.get_custom_threat_feed()
```

## Performance Considerations

1. **Caching**: Intelligence data is cached to minimize API calls
2. **Asynchronous Operations**: Intelligence lookups are performed asynchronously when possible
3. **Rate Limiting**: Respects API rate limits for external services

## Privacy and Compliance

1. **Data Handling**: No sensitive data is transmitted to external services without explicit consent
2. **Local Processing**: Most intelligence processing happens locally
3. **Audit Trail**: All intelligence lookups are logged for compliance purposes

## Troubleshooting

### Common Issues

1. **API Key Errors**: Ensure NVD_API_KEY is properly set
2. **Network Connectivity**: Verify network access to intelligence services
3. **Rate Limiting**: Check for API rate limit errors in logs

### Logs

Intelligence integration logs can be found in:
- Standard application logs
- `runs/<target>/<run_id>/logs/` directory